webpackJsonp([2],{"/Hv2":function(e,t){},0:function(e,t){},"0BjV":function(e,t){},1:function(e,t){},2:function(e,t){},Burn:function(e,t){},C5dq:function(e,t){},F5Rg:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA+pJREFUWAnFV0ls00AU/XbsLKRp2nRJoVCKUCkCuohFgNgEEpwAIYoE4oCEOHKAOxJ3jghx4QQX4Aw9cGcrEi07YmlRBZTSlgSSNKvtmHlubCWOl0QqdKRkZv5/89+s/39zVGPpf/UzmMukLviF7CmRl1aKnBQUPZKI4ZIiSpIqpqWi+D0nB+76l4Wuvh7oSNdimnMDrX8+0ectpm+HvYmNHk52xcOeogpqohB+V+CDpz9sXfvGicPWYO+juZAozg5HfLE9PKfY4pyMF1WPGs+3PJSk9sMfd7elrLCWhrHqEBd/HBTmQ1aD6pWl5YZUSo3sstoN3mysZ2RiKOKZGVssctiHLdjseTpx3MxXsQNYOYBePi+YgYvRLxR9clyJbi7fCWMCOPPGwORUPSsXOI4ONXfQQDBMSVmm0fk4jaTijnPFcSSz3Z36nTBWigtXC3mzINLJtlXUG2ikLl+AIqLPIDzRtpJuTH+hO3NfDZm5AY4s42LyfdBpO4CtbxemXrnddoBvrttGXf4gxlqW95kknR8fs9TpQryOWblzAEehXUK8czdyDG4RvI7kwLyc/4PKsYALnADx8HBwMo4jSkov73GFfc9nXDEAgBPcPNxrrR7uXEe3q/Ez0W7yLJysIxac4Obh2x2RZcqegLtf6vD6qVEw7nbZ6OomuHkElmqVtSQm5a0VZdKsIlNaUcok9k1w84hq9pBKzaXJt4RbbleyRYXOfnpOBbVoB6mQg5vXQ2qFxqaTYQRPk780LSjUEk4ptd6mEzQj5WxGV4vBXRULqmGVkvuxaUrJEiXkAl378Zn9xuljZiHQ3XVwQJVWSj22Am7H2Eje78l6LQE2wp2hFrq8egP5y57lrZlJusl+9ZScEihwW0ZH4yEh2VzPQGC7fMvoQFM7BXmBnrBjeZF2d0BmjpTc+JtHGmVWuPWPRJYzYo+24uvT45Rjd2OotebHZJgHt4AcjrzUZ0htGgebojTY0ESr2Mr7WPRDSbC7gBJmAQplf7iNvuWz9CaToAfxaXJ7C+DmNFesfk7ZeUPc0itr+mlrKKKR1PqHF3Fx4iXpL8Q8TssbuZ4Qj+wVCaQZoPePtqyomxxjN7FdOtbaqZupqsEJbu0ZIntFiKxCMcFgQ9330zDTXzoqQ1BqgAuc6GpOG3FZePbuYat/dq8ZfC82xdJslep1GDj/4dgPszmtj0z5w/aFdN2IGkid00KmKiUbY/Edv8UqSMnApdszFoYcDakzEkddudg1bINDzwdh35gAOjiKuXz01L+YBGzO5aInwQEuvRhZsS5A/T8/TCwngEks6acZJqAX7MaSfJzqE9Drf/V5/hczc9SNbKSTnwAAAABJRU5ErkJggg=="},Frah:function(e,t){},HQ9v:function(e,t){},KQzG:function(e,t){},McPR:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("IvJb"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var n=a("C7Lr")({name:"App"},s,!1,function(e){a("Burn")},null,null).exports,l=a("zO6J"),r=a("3cXf"),i=a.n(r),c=a("rVsN"),d=a.n(c),p=a("aozt"),m=a.n(p);function u(e){return new d.a(function(t,a){m.a.defaults.withCredentials=!0,m.a.create({headers:{"Content-Type":"application/json"},timeout:3e4})(e).then(function(e){t(e)}).catch(function(e){console.log("请求异常信息："+e),a(e)})})}var g="http://116.62.138.218:8889";function h(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function v(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function f(e){return u({async:!1,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function y(e,t){return u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})}function b(e){return u({async:!1,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function w(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function x(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function S(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}function D(e){return u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})}a("KPSb");var _={data:function(){return{logining:!1,loginForm:{account:"",password:""},rules2:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){console.log("初始账号：admin，初始密码：admin")},methods:{login:function(){var e=this;this.logining=!0;var t={userName:this.loginForm.account,password:this.loginForm.password};t=i()(t),console.log(t),function(e,t){return console.log(t),u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})}("/admin/login",t).then(function(t){if(console.log(t.data),"1"==t.data.code){var a=t.data.data;console.log(a),sessionStorage.setItem("user",i()(a)),e.$router.push({path:"/sentrylist"})}else e.logining=!1,e.$message({message:"账号或密码错误!",type:"warning"})}).catch(function(t){e.logining=!1,e.$message({message:"网络错误!",type:"error"})})}}},N={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"loginBox"},[a("el-form",{ref:"loginForm",staticClass:"login-container",attrs:{model:e.loginForm,rules:e.rules2,"label-position":"top","label-width":"0px"}},[a("span",{staticClass:"title"},[e._v("综治哨所后台管理系统")]),e._v(" "),a("el-form-item",{attrs:{label:"账号","label-width":"120px"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"请输入账号"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":"120px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"loginBth",attrs:{type:"primary",loading:e.logining},nativeOn:{click:function(t){return t.preventDefault(),e.login(t)}}},[e._v("登录")])],1)],1)],1)])},staticRenderFns:[]};var E=a("C7Lr")(_,N,!1,function(e){a("KQzG")},null,null).exports,T=a("a3Yh"),C=a.n(T),P={data:function(){return{}},components:{},computed:{},created:function(){},methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"aside"},[a("el-col",{attrs:{span:12}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{open:e.handleOpen,close:e.handleClose}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("哨兵管理")])]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/sentrylist"}},[e._v("哨兵列表")]),e._v(" "),a("el-menu-item",{attrs:{index:"/sentryadd"}},[e._v("添加哨兵")])],1)],2),e._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("哨所管理")])]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/postlist"}},[e._v("哨所列表")]),e._v(" "),a("el-menu-item",{attrs:{index:"/postadd"}},[e._v("添加哨所")])],1)],2),e._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("积分管理")])]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/Integralrank"}},[e._v("积分排行")]),e._v(" "),a("el-menu-item",{attrs:{index:"/Integralexchange"}},[e._v("积分兑换")])],1)],2),e._v(" "),a("el-submenu",{attrs:{index:"4"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("事件管理")])]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/reportevent"}},[e._v("事件列表")])],1)],2)],1)],1)],1)},staticRenderFns:[]};var k=a("C7Lr")(P,$,!1,function(e){a("yx2Z")},null,null).exports,O={data:function(){return{currentPage:1,tablePageNumber:1e3}},created:function(){var e=this;this.$root.count.$on("getTablePageNumber",function(t){e.tablePageNumber=t}),this.$root.count.$on("pageReturnZero",function(t){e.currentPage=1})},methods:{handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){switch(console.log("当前页: "+e),console.log(this.$route.path),this.$route.path){case"/sentrylist":this.getSentryListTable(e,10);break;case"/postlist":this.getPostListTable(e,10);break;case"/reporteventlist":this.getEventListTable(e,10);break;case"/Integrallist":this.getIntegralListTable(e,10);break;case"/Integralrank":this.getIntegralrankTable(e,10)}},getSentryListTable:function(e,t){console.log(e+":"+t),this.$root.page.$emit("getSentryListTable",e)},getPostListTable:function(e,t){console.log(e+":"+t),this.$root.page.$emit("getPostListTable",e)},getEventListTable:function(e,t){console.log(e+":"+t),this.$root.page.$emit("getEventListTable",e)},getIntegralListTable:function(e,t){console.log(e+":"+t),this.$root.page.$emit("getIntegralListTable",e)},getIntegralrankTable:function(e,t){console.log(e+":"+t),this.$root.page.$emit("getIntegralrankTable",e)}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paging"},[a("el-row",{staticClass:"paging",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:22}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{layout:"prev, pager, next","current-page":e.currentPage,total:e.tablePageNumber},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)])],1)],1)},staticRenderFns:[]};var I=a("C7Lr")(O,L,!1,function(e){a("C5dq")},null,null).exports,A={data:function(){return{ifShow:!1,userName:"admin",sentryNum:0,postNum:0,eventNum:0}},created:function(){this.getSentryPostEventNum(),console.log(JSON.parse(sessionStorage.getItem("user")).nickName);var e=JSON.parse(sessionStorage.getItem("user")).nickName;this.userName=e},methods:{clickNavDown:function(){!0===this.ifShow?this.ifShow=!1:this.ifShow=!0},openExitSystem:function(){this.$router.push({path:"/"})},getSentryPostEventNum:function(){var e=this,t=["/report/page?page=0&size=10&postCode=&person=&eventName=&time=","/post/page?page=0&size=10&code=&grade=","/sentry/page?page=0&size=10&idNumber=&name=&postCode="];for(var a in t)2==a?f(t[2]).then(function(t){if("1"==t.data.code){var a=t.data.data.totalElements;console.log(a),e.sentryNum=a}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})}):1==a?b(t[1]).then(function(t){if("1"==t.data.code){var a=t.data.data.totalElements;console.log(a),e.postNum=a}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})}):0==a&&S(t[0]).then(function(t){if("1"==t.data.code){var a=t.data.data.totalElements;console.log(a),e.eventNum=a}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})}}},U={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"header"},[o("el-row",{attrs:{type:"flex",justify:"center"}},[o("el-col",{attrs:{span:24}},[o("div",{staticClass:"headerCon"},[o("ul",{staticClass:"overview"},[o("li",[e._v("哨兵总数:\n            "),o("span",{domProps:{textContent:e._s(e.sentryNum)}})]),e._v(" "),o("li",[e._v("哨所总数:\n            "),o("span",{domProps:{textContent:e._s(e.postNum)}},[e._v("1121")])]),e._v(" "),o("li",[e._v("事件总数:\n            "),o("span",{domProps:{textContent:e._s(e.eventNum)}},[e._v("1121")])])]),e._v(" "),o("ul",{staticClass:"user"},[o("li",{staticClass:"signOut",on:{click:e.clickNavDown}},[o("img",{attrs:{src:a("cVKh"),alt:""}})]),e._v(" "),o("li",{staticClass:"userInfo"},[o("span",[e._v(e._s(e.userName))]),o("img",{attrs:{src:a("F5Rg"),alt:""}})])]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:e.ifShow,expression:"ifShow"}],staticClass:"exit",on:{click:e.openExitSystem}},[e._v("退出账号")])])])],1)],1)},staticRenderFns:[]};var z=a("C7Lr")(A,U,!1,function(e){a("Frah")},null,null).exports,M={data:function(){var e;return e={formPostName:"",isShowEditUser:!0,loading:!1,addPostDataModel:!1,modelName:"添加哨所",formLabelWidth:"120",tableDataExportModel:!1,tableDataExportNum:0,tableDataExportColor:"#8e71c7",tableDataExportStatus:""},C()(e,"formLabelWidth","120"),C()(e,"tableDataExportPostName",""),C()(e,"exportTableData",[]),C()(e,"isExportDataComplete",!1),C()(e,"YearMonthDay",""),C()(e,"addOrEditPostData",{postName:"",postNumber:"",postTown:"",postLevel:"",superiorPostName:""}),C()(e,"pageNum",0),C()(e,"pageStripNum",10),C()(e,"isShowPostUpload",!0),C()(e,"isShowUpPost",!1),C()(e,"isAddType",!0),C()(e,"postId",0),C()(e,"postCode",0),C()(e,"form",{unitTown:"",postLevel:"",postName:"",postNumber:"",postCode:""}),C()(e,"selectTown",[]),C()(e,"selectPostName",[]),C()(e,"superiorPostName",[]),C()(e,"postTableData",[]),e},components:{myAside:k,myPaging:I,myHeader:z},computed:{},created:function(){var e=this;"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0),this.getTownList(),this.getPostData(this.form),this.$root.page.$on("getPostListTable",function(t){e.pageNum=t-1,console.log(e.pageNum),e.getPostData(e.form)}),this.addOrEditPostDataEmpty=JSON.parse(i()(this.addOrEditPostData))},mounted:function(){},destroyed:function(){for(var e in console.log("离开当前页面后执行"),this.form)this.form[e]=""},methods:{formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},export_Excel:function(){var e=this;this.$confirm("确定要导出表格数据么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form.unitTown;console.log(t),e.getPostNameByPostCode(t),e.exportTableDataFun(),e.tableDataExportModel=!0,console.log(e.isExportDataComplete)}).catch(function(e){console.log(e)})},exportDataTrue:function(){var e=this;a.e(0).then(function(){var t=a("zWO4").exportJsonToExcel,o=e.exportTableData;t(["哨所名称","哨所编号","哨所等级"],e.formatJson(["postName","postNumber","postLevel"],o),e.tableDataExportPostName+"哨所列表")}.bind(null,a)).catch(a.oe)},getYearMonthDay:function(){},getPostNameByPostCode:function(e){if(""==e)this.tableDataExportPostName="全部";else for(var t in console.log(this.selectTown),this.selectTown)this.selectTown[t].value==parseInt(e)&&(this.tableDataExportPostName=this.selectTown[t].label)},exportTableDataFun:function(){var e=this,t="";t=""==this.form.unitTown?"":this.form.unitTown+"-",console.log("导出表格数据");var a=[];b("/post/page?page=0&size=10000&code="+t+"&grade=").then(function(t){if(console.log(t),"1"==t.data.code){var o=t.data.data.content;console.log(t.data.data);for(var s=0;s<o.length;s++)console.log(parseInt(s/o.length*100)),e.tableDataExportNum=parseInt(s/o.length*100),a.push({postName:o[s].name,postNumber:o[s].number||"未知",postLevel:o[s].grade||"未知"});e.tableDataExportNum=100,e.tableDataExportColor="",e.tableDataExportStatus="success",setTimeout(e.tableDataExportModel=!1,1e3),console.log("下载完成"),console.log(a),e.exportTableData=a,e.isExportDataComplete=!0,e.exportDataTrue()}else"0"==t.data.code?(e.tableDataExportStatus="exception",e.$message({message:t.data.data,type:"warning"})):"-1"==t.data.code&&(e.tableDataExportStatus="exception",e.$message({message:"网络错误!",type:"error"}))}).catch(function(t){console.log(t),e.tableDataExportStatus="exception",e.$message({message:"网络错误",type:"error"})})},addPostDataModelTrue:function(){this.addPostDataModel=!0,this.modelName="添加哨所",this.isShowPostUpload=!0,this.isAddType=!0,this.addOrEditPostData=JSON.parse(i()(this.addOrEditPostDataEmpty))},indexMethod:function(e){return 1*e},getSelectTown:function(){this.form.postLevel="",this.form.postCode="",this.form.postName="",this.form.postNumber="",this.pageNum=0,this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.getPostData(this.form)},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostLevel:function(){console.log(this.form),this.selectPostName="",this.form.postCode="",this.form.postNumber="",this.form.postName="",this.pageNum=0,this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.getAllPostListFun(),this.getPostData(this.form)},getPostName:function(){this.pageNum=0,this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.getPostData(this.form)},getAllPostListFun:function(){var e=this,t=[],a=this.addOrEditPostData,o=this.form.unitTown||a.postTown,s=this.form.postLevel||a.postLevel;console.log(a.postLevel),"添加哨所"==this.modelName&&a.postLevel>1?(console.log("添加哨所"),s=parseInt(s)-1,this.isShowUpPost=!0,this.addOrEditPostData.superiorPostName="",console.log(this.isShowUpPost)):1==a.postLevel&&(this.isShowUpPost=!1,this.addOrEditPostData.superiorPostName=o+"-0-0"),console.log(o),console.log(s),console.log("获取哨所列表"),v("/post/all?code="+o+"-&grade="+s).then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectPostName=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostData:function(e){var t=this;console.log("搜索关键字："+i()(this.form)),console.log(e.unitTown),console.log(e.postLevel),void 0==e.unitTown&&(e.unitTown=""),void 0==e.postLevel&&(e.postLevel="");var a=e.postLevel,o="";""==e.unitTown&&""==e.postLevel&&""==e.postCode?o="":""!=e.unitTown&&""==e.postLevel&&""==e.postCode?o=e.unitTown+"-":""!=e.unitTown&&""!=e.postLevel&&""==e.postCode?o=e.unitTown+"-"+e.postLevel:""!=e.unitTown&&""!=e.postLevel&&""!=e.postCode&&(o=e.postCode);var s=[];b("/post/page?page="+this.pageNum+"&size="+this.pageStripNum+"&code="+o+"&grade="+a+"&name="+this.formPostName+"&number=").then(function(e){if(console.log(e),"1"==e.data.code){var a=e.data.data.content;console.log(a),t.tablePageNumber=e.data.data.totalElements,t.$root.count.$emit("getTablePageNumber",t.tablePageNumber);for(var o=0;o<a.length;o++)s.push({postName:a[o].name||"未知",postNumber:a[o].number||"未知",postLevel:a[o].grade||"未知",postWhereTown:"未知",postSentryNum:"未知",postSuperiorPost:"未知",postReportNum:"未知",postId:a[o].id,postCode:a[o].code});console.log(s),t.postTableData=s}else"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),t.$message({message:"网络错误",type:"error"})})},editPostInfo:function(e,t){console.log(e,t),this.modelName="编辑哨所",this.isShowPostUpload=!1,this.addPostDataModel=!0,this.isAddType=!1,this.postId=t.postId,this.postCode=t.postCode,this.addOrEditPostData.postName=t.postName,this.addOrEditPostData.postNumber=t.postNumber},SubmitPostData:function(){var e=this;console.log(this.addOrEditPostData);var t,a,o=this.addOrEditPostData,s=o.postTown+"-"+o.postLevel;if(this.isAddType){var n={name:this.addOrEditPostData.postName,grade:this.addOrEditPostData.postLevel,number:this.addOrEditPostData.postNumber,type:this.addOrEditPostData.postNumber,code:s,superPostCode:this.addOrEditPostData.superiorPostName,zzBank:""};console.log(n),console.log("add"),(t="/post/add",a=n,u({async:!0,url:g+t,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:a})).then(function(t){console.log(t),"1"==t.data.code?(e.$message({type:"success",message:"添加哨所信息成功!"}),e.addOrEditPostData=JSON.parse(i()(e.addOrEditPostDataEmpty)),e.addPostDataModel=!1,e.modelName="添加哨所",e.isShowPostUpload=!0,e.getPostData(e.form)):"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){e.$message({message:"网络错误!",type:"error"})})}else{var l={id:this.postId,name:this.addOrEditPostData.postName,number:this.addOrEditPostData.postNumber,type:this.addOrEditPostData.postNumber,zzBank:""};console.log(l),console.log("upload"),function(e,t){return u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})}("/post/update",l).then(function(t){console.log(t),"1"==t.data.code?(e.$message({type:"success",message:"修改哨所信息成功!"}),e.addOrEditPostData=JSON.parse(i()(e.addOrEditPostDataEmpty)),e.addPostDataModel=!1,e.isShowPostUpload=!0,e.getPostData(e.form)):"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误!",type:"error"})})}},deletePostInfo:function(e,t){var a=this;console.log(e,t);var o=t.postId;console.log("delectId:"+o),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deletePostInfoSure(o)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deletePostInfoSure:function(e){var t,a=this;console.log("delete"),console.log(e),(t="/post/del?id="+e,u({async:!0,url:g+t,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"删除成功!"}),a.getPostData(a.form)):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}}},R={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"postList outerDiv",attrs:{id:"postList"}},[a("div",{staticClass:"postListBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"数据导出进度",visible:e.tableDataExportModel,width:"30%",center:""},on:{"update:visible":function(t){e.tableDataExportModel=t}}},[a("el-progress",{attrs:{percentage:e.tableDataExportNum,status:e.tableDataExportStatus,color:e.tableDataExportColor}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.modelName,"custom-class":"addOrEditPost addOrEdit",visible:e.addPostDataModel,width:"60%"},on:{"update:visible":function(t){e.addPostDataModel=t}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:e.addOrEditPostData,inline:!0,"label-position":"right"}},[a("el-form-item",{attrs:{label:"哨所名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入哨所名称"},model:{value:e.addOrEditPostData.postName,callback:function(t){e.$set(e.addOrEditPostData,"postName",t)},expression:"addOrEditPostData.postName"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowPostUpload,expression:"isShowPostUpload"}],attrs:{label:"哨所编号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入哨所编号"},model:{value:e.addOrEditPostData.postNumber,callback:function(t){e.$set(e.addOrEditPostData,"postNumber",t)},expression:"addOrEditPostData.postNumber"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowPostUpload,expression:"isShowPostUpload"}],attrs:{label:"单位\\乡镇场","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",filterable:"",placeholder:"请选择单位\\乡镇场"},model:{value:e.addOrEditPostData.postTown,callback:function(t){e.$set(e.addOrEditPostData,"postTown",t)},expression:"addOrEditPostData.postTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowPostUpload,expression:"isShowPostUpload"}],attrs:{label:"哨所等级","label-width":e.formLabelWidth,clearable:""}},[a("el-select",{attrs:{size:"small",placeholder:"请选择哨所等级"},on:{change:e.getPostLevel},model:{value:e.addOrEditPostData.postLevel,callback:function(t){e.$set(e.addOrEditPostData,"postLevel",t)},expression:"addOrEditPostData.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1)],1),e._v(" "),e.isShowUpPost?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowPostUpload,expression:"isShowPostUpload"}],attrs:{label:"上级哨所","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",filterable:"",placeholder:"请选择上级哨所"},model:{value:e.addOrEditPostData.superiorPostName,callback:function(t){e.$set(e.addOrEditPostData,"superiorPostName",t)},expression:"addOrEditPostData.superiorPostName"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e()],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addPostDataModel=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.SubmitPostData}},[e._v("提交")])],1)],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",placeholder:"请选择单位\\乡镇场",clearable:""},on:{change:e.getSelectTown},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"哨所等级",clearable:""},on:{change:e.getPostLevel},model:{value:e.form.postLevel,callback:function(t){e.$set(e.form,"postLevel",t)},expression:"form.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"280px"},attrs:{size:"small",placeholder:"哨所名称",filterable:"",clearable:""},on:{change:e.getPostName},model:{value:e.form.postCode,callback:function(t){e.$set(e.form,"postCode",t)},expression:"form.postCode"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"180px",display:"none"},attrs:{size:"small",placeholder:"请输入哨所编号",clearable:""},on:{change:e.getPostData},model:{value:e.form.postNumber,callback:function(t){e.$set(e.form,"postNumber",t)},expression:"form.postNumber"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-input",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请输入哨所名称",clearable:""},on:{change:e.getPostData},model:{value:e.formPostName,callback:function(t){e.formPostName=t},expression:"formPostName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",loading:e.loading},on:{click:e.getPostData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-download",loading:e.loading},on:{click:e.export_Excel}},[e._v("导出数据")]),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"0",top:"4px"},attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addPostDataModelTrue}},[e._v("添加哨所")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.postTableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所名称",prop:"postName"}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所编号",prop:"postNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所等级",prop:"postLevel"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit",on:{click:function(a){a.stopPropagation(),e.editPostInfo(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deletePostInfo(t.$index,t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("my-paging")],1)],1)],1)],1)])},staticRenderFns:[]};var B=a("C7Lr")(M,R,!1,function(e){a("Rh3i")},null,null).exports,F={data:function(){return{tableDataExportModel:!1,tableDataExportNum:0,tableDataExportColor:"#8e71c7",tableDataExportStatus:"",formLabelWidth:"120",tableDataExportPostName:"",exportTableData:[],isExportDataComplete:!1,YearMonthDay:"",loading:!1,isShowEditUser:!0,form:{unitTown:"",postLevel:"",postCode:"",reportTime:"",sentryName:"",eventName:"",startTime:"",endTime:"",eventState:"",reportStartTime:"",reportEndTime:""},pageNum:0,pageStripNum:10,selectTown:[],selectPostName:[],selectSentryName:[],selectEventName:[],eventTableData:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},isReportStartTime:!0,displayReportEvent:!1,reportEventCount:[],reportEventName:[]}},components:{myAside:k,myPaging:I,myHeader:z},computed:{},created:function(){var e=this;"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0),this.getTownList(),this.getAllReportEventFun(),this.getTableData(),this.$root.page.$on("getEventListTable",function(t){e.pageNum=t-1,console.log(e.pageNum),e.getTableData()})},destroyed:function(){for(var e in console.log("离开当前页面后执行"),this.form)this.form[e]=""},methods:{displayReportEventClick:function(){this.displayReportEvent=!0;var e=this;setTimeout(function(){e.drawLine()},500)},unlockReportEndTime:function(){null!=this.form.reportStartTime&&(this.isReportStartTime=!1)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},export_Excel:function(){var e=this;this.$confirm("确定要导出表格数据么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form.unitTown;console.log(t),e.getPostNameByPostCode(t),e.exportTableDataFun(),e.tableDataExportModel=!0,console.log(e.isExportDataComplete)}).catch(function(e){console.log(e)})},exportDataTrue:function(){var e=this;a.e(0).then(function(){var t=a("zWO4").exportJsonToExcel,o=e.exportTableData;t(["事件状态","事件类型","事件上报人","事件上报时间","事件内容","事件附件图片","事件审核人","事件审批人"],e.formatJson(["eventState","eventType","eventReportName","eventReportTime","eventContent","eventImages","eventExamine","eventApproval"],o),e.tableDataExportPostName+"上报事件列表")}.bind(null,a)).catch(a.oe)},getYearMonthDay:function(){},getPostNameByPostCode:function(e){if(""==e)this.tableDataExportPostName="全部";else for(var t in console.log(this.selectTown),this.selectTown)this.selectTown[t].value==parseInt(e)&&(this.tableDataExportPostName=this.selectTown[t].label)},exportTableDataFun:function(){var e=this,t="";t=""==this.form.unitTown?"":this.form.unitTown+"-",console.log("导出表格数据");var a=[];S("/report/page?page=0&size=10000&postCode="+t+"&person=&eventName=&time=").then(function(t){if(console.log(t),"1"==t.data.code){var o=t.data.data.content;console.log(t.data.data);for(var s=0;s<o.length;s++){console.log(parseInt(s/o.length*100)),e.tableDataExportNum=parseInt(s/o.length*100);var n="";n=0==o[s].reportImageList.length?"无":"有",a.push({eventState:0==o[s].finish?"进行中":1==o[s].finish?"已完成":"已拒绝",eventType:o[s].sort||"未知",eventReportName:o[s].person||"未知",eventReportTime:o[s].time,eventContent:o[s].content||"未知",eventImages:n,eventExamine:o[s].twoPassSentryName||"未知",eventApproval:o[s].onePassSentryName||"未知"})}e.tableDataExportNum=100,e.tableDataExportColor="",e.tableDataExportStatus="success",setTimeout(e.tableDataExportModel=!1,1e3),console.log("下载完成"),console.log(a),e.exportTableData=a,e.isExportDataComplete=!0,e.exportDataTrue()}else"0"==t.data.code?(e.tableDataExportStatus="exception",e.$message({message:t.data.data,type:"warning"})):"-1"==t.data.code&&(e.tableDataExportStatus="exception",e.$message({message:"网络错误!",type:"error"}))}).catch(function(t){console.log(t),e.tableDataExportStatus="exception",e.$message({message:"网络错误",type:"error"})})},indexMethod:function(e){return 1*e},getAllReportEventFun:function(){var e,t=this,a=[];console.log("获取上报事件类型"),(e="/event/all",u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){if("1"==e.data.code){var o=e.data.data;console.log(o);for(var s=0;s<o.length;s++)a.push({value:o[s].name,label:o[s].name});console.log(a),t.selectEventName=a}else"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),t.$message({message:"网络错误",type:"error"})})},getSelectTown:function(){this.form.postLevel="",this.form.postCode="",this.form.eventState="",this.form.sentryName="",this.form.reportTime="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,console.log(this.form.unitTown),this.getTableData()},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)console.log("***"),t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostLevel:function(){this.selectPostName="",this.form.postCode="",this.form.eventState="",this.form.sentryName="",this.form.reportTime="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getAllPostListFun(),this.getTableData()},getPostName:function(){this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getTableData()},getAllPostListFun:function(){var e=this,t=[],a=this.form.unitTown,o=this.form.postLevel;console.log(a),console.log(o),console.log("获取哨所列表"),v("/post/all?code="+a+"-&grade="+o).then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectPostName=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getTableData:function(){var e=this;console.log("搜索关键字："+i()(this.form));var t=this.form,a="";""==t.unitTown&&""==t.postLevel&&""==t.postCode?a="":""!=t.unitTown&&""==t.postLevel&&""==t.postCode?a=t.unitTown+"-":""!=t.unitTown&&""!=t.postLevel&&""==t.postCode?a=t.unitTown+"-"+t.postLevel:""!=t.unitTown&&""!=t.postLevel&&""!=t.postCode&&(a=t.postCode);var o=t.eventState,s=t.sentryName,n=t.eventName,l=t.reportTime,r=t.reportStartTime;console.log(parseInt(t.reportEndTime.split("-")[2])+1);var c=new Array;c[0]=t.reportEndTime.split("-")[0],c[1]=t.reportEndTime.split("-")[1],c[2]=parseInt(t.reportEndTime.split("-")[2])+1<10?"0"+(parseInt(t.reportEndTime.split("-")[2])+1):parseInt(t.reportEndTime.split("-")[2])+1;var d=c.join("-");null==l&&(l=""),null==r&&(l=""),null==d&&(l="");var p=[];S("/report/page?page="+this.pageNum+"&size="+this.pageStripNum+"&postCode="+a+"&person="+s+"&eventName="+n+"&startTime="+r+"&endTime="+d+"&finish="+o).then(function(t){if("1"==t.data.code){var a=t.data.data.content;console.log(t.data.data),e.tablePageNumber=t.data.data.totalElements,e.$root.count.$emit("getTablePageNumber",e.tablePageNumber);for(var o=0;o<a.length;o++){var s="";s=0==a[o].reportImageList.length?"无":"点击查看",p.push({eventState:0==a[o].finish?"进行中":1==a[o].finish?"已完成":"已拒绝",eventType:a[o].sort,eventReportName:a[o].person,eventReportTime:a[o].time,eventContent:a[o].content,eventImages:s,eventExamine:a[o].twoPassSentryName,eventApproval:a[o].onePassSentryName,eventReportPost:a[o].postName,eventReportLevel:a[o].postGrade,id:a[o].id})}console.log(p),e.eventTableData=p}else e.$message({message:"获取数据失败",type:"warning"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})}),D("/report/eventCount?postCode="+a+"&person=&eventName=&startTime="+r+"&endTime="+d+"&finish="+o).then(function(t){if("1"==t.data.code){e.reportEventName=[],e.reportEventCount=[];t.data.data;for(var a in console.log(t.data.data),t.data.data)0!=t.data.data[a].count&&(e.reportEventName.push(t.data.data[a].name),e.reportEventCount.push({value:t.data.data[a].count,name:t.data.data[a].name}))}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},drawLine:function(){this.$echarts.init(document.getElementById("myChart")).setOption({tooltip:{trigger:"item"},legend:{bottom:20,left:"center"},series:[{type:"pie",radius:"55%",center:["50%","40%"],selectedMode:"single",data:this.reportEventCount,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},deleteEventInfo:function(e,t){var a=this;console.log(e,t);var o=t.id;console.log("delectId:"+o),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteEventInfoSure(o)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteEventInfoSure:function(e){var t,a=this;console.log("delete"),console.log(e),(t="/report/delete?id="+e,u({async:!0,url:g+t,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"删除成功!"}),a.getTableData()):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}}},j={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"reportEventList outerDiv",attrs:{id:"reportEventList"}},[a("div",{staticClass:"reportEventListBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"显示上报事件分布详情",visible:e.displayReportEvent,width:"50%",center:""},on:{"update:visible":function(t){e.displayReportEvent=t}}},[a("div",{style:{width:"100%",height:"500px"},attrs:{id:"myChart"}})]),e._v(" "),a("el-dialog",{attrs:{title:"数据导出进度",visible:e.tableDataExportModel,width:"30%",center:""},on:{"update:visible":function(t){e.tableDataExportModel=t}}},[a("el-progress",{attrs:{percentage:e.tableDataExportNum,status:e.tableDataExportStatus,color:e.tableDataExportColor}})],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},on:{change:e.getSelectTown},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所等级"},on:{change:e.getPostLevel},model:{value:e.form.postLevel,callback:function(t){e.$set(e.form,"postLevel",t)},expression:"form.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所名称"},on:{change:e.getPostName},model:{value:e.form.postCode,callback:function(t){e.$set(e.form,"postCode",t)},expression:"form.postCode"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"上报哨兵姓名",clearable:""},on:{change:e.getTableData},model:{value:e.form.sentryName,callback:function(t){e.$set(e.form,"sentryName",t)},expression:"form.sentryName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"事件类型",filterable:"",clearable:""},on:{change:e.getTableData},model:{value:e.form.eventName,callback:function(t){e.$set(e.form,"eventName",t)},expression:"form.eventName"}},e._l(e.selectEventName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"事件状态",clearable:""},on:{change:e.getTableData},model:{value:e.form.eventState,callback:function(t){e.$set(e.form,"eventState",t)},expression:"form.eventState"}},[a("el-option",{attrs:{label:"已完成",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"0"}})],1),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small","value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"开始时间","picker-options":e.pickerOptions},on:{change:e.unlockReportEndTime},model:{value:e.form.reportStartTime,callback:function(t){e.$set(e.form,"reportStartTime",t)},expression:"form.reportStartTime"}}),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small",disabled:e.isReportStartTime,"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"结束时间","picker-options":e.pickerOptions},on:{change:e.getTableData},model:{value:e.form.reportEndTime,callback:function(t){e.$set(e.form,"reportEndTime",t)},expression:"form.reportEndTime"}}),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",loading:e.loading},on:{click:e.getTableData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-download",loading:e.loading},on:{click:e.export_Excel}},[e._v("导出数据")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-view",loading:e.loading},on:{click:e.displayReportEventClick}},[e._v("查看分类详情")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.eventTableData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"事件状态"}},[a("span",[e._v(e._s(t.row.eventState))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件类型"}},[a("span",[e._v(e._s(t.row.eventType))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件上报人"}},[a("span",[e._v(e._s(t.row.eventReportName))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件上报时间"}},[a("span",[e._v(e._s(t.row.eventReportTime))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件内容"}},[a("span",[e._v(e._s(t.row.eventContent))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件附件图片"}},[a("span",[e._v(e._s(t.row.eventImages))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件审核人"}},[a("span",[e._v(e._s(t.row.eventExamine))])]),e._v(" "),a("el-form-item",{attrs:{label:"事件审批人"}},[a("span",[e._v(e._s(t.row.eventApproval))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"事件状态",prop:"eventState",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"事件类型",prop:"eventType",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{label:"上报人姓名",prop:"eventReportName",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"上报人所在哨所",prop:"eventReportPost"}}),e._v(" "),a("el-table-column",{attrs:{label:"上报人哨所等级",prop:"eventReportLevel",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"上报时间",prop:"eventReportTime",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deleteEventInfo(t.$index,t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("my-paging")],1)],1)],1)],1)])},staticRenderFns:[]};var J=a("C7Lr")(F,j,!1,function(e){a("w+Yn")},null,null).exports,W={data:function(){return{isBatchImportSuccess:!0,loading:!1,addSentryDataModel:!1,tableDataExportModel:!1,tableDataExportNum:0,tableDataExportColor:"#8e71c7",tableDataExportStatus:"",tableDataExportPostName:"",exportTableData:[],isExportDataComplete:!1,formLabelWidth:"120",addOrEditSentryData:{sentryNumber:"",sentryName:"",sentrySex:"",sentryNumberID:"",sentryPosition:"",postLevel:"",postName:"",postNumber:"",postOffice:"",sentryTel:"",isScoring:"",isSerious:"",postTown:""},editSentryId:0,editSentrysentryId:0,sentryCode:"",PostCode:"",modelName:"添加哨兵",isShowSentryUpload:!0,pageNum:0,pageStripNum:10,form:{unitTown:"",postLevel:"",postCode:"",sentryNumberID:"",sentryName:""},isShowEditUser:!1,selectTown:[],selectPostName:[],sentryTableData:[],tablePageNumber:0,isAddType:!0}},components:{myAside:k,myPaging:I,myHeader:z},created:function(){this.getTownList(),this.getSentryData(this.form),this.addOrEditSentryDataEmpty=JSON.parse(i()(this.addOrEditSentryData)),"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0)},mounted:function(){var e=this;this.$root.page.$on("getSentryListTable",function(t){e.pageNum=t-1,console.log(e.pageNum),e.getSentryData(e.form)})},destroyed:function(){for(var e in console.log("离开当前页面后执行"),this.form)this.form[e]=""},methods:{importfxx:function(e){var t=this;this.$refs.inputer;this.file=event.currentTarget.files[0];var o=this.file,s=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var o,s,n="",l=new FileReader;l.onload=function(e){for(var r=new Uint8Array(l.result),i=r.byteLength,c=0;c<i;c++)n+=String.fromCharCode(r[c]);var d=a("5ksI");o=d.read(n,{type:"binary"}),s=d.utils.sheet_to_json(o.Sheets[o.SheetNames[0]]),console.log("outdata就是你想要的东西"),console.log(s),t.batchAddSentry(s)},l.readAsArrayBuffer(e)},s.readAsBinaryString(o)},batchAddSentry:function(e){for(var t in console.log("批量添加哨兵"),e){var a={idNumber:e[t].身份证号,postCode:"",postOffice:e[t].哨所职务,canScoring:"是"==e[t].是否拥有计分权限?"1":"0",isPolice:"是"==e[t].是否驻村民警?"1":"0",phone:e[t].手机号,position:e[t].职位,postGrade:e[t].哨所级别,name:e[t].哨兵姓名,sex:e[t].性别};console.log("add"),setTimeout(this.getPostCodeByPostName(this.batchAddSentryFun,e[t].哨所名称,a),1e3)}},batchAddSentryFun:function(e){var t=this;console.log(e),y("/sentry/add",e).then(function(e){console.log(e),"1"==e.data.code?console.log("OK"):"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(a){console.log(a),console.log("添加失败"),console.log(e.name),t.batchAddSentryFun(e),t.$message({message:"网络错误!",type:"error"})})},getPostCodeByPostName:function(e,t,a){var o=this;b("/post/page?page=0&size=10&code=&grade=&name="+t+"&number=").then(function(t){if(console.log(t),"1"==t.data.code){var s=t.data.data.content[0].code;console.log(s),a.postCode=s,o.batchAddSentryPost=s,e(a)}else"0"==t.data.code?o.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&o.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),o.$message({message:"网络错误",type:"error"})})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},export_Excel:function(){var e=this;this.$confirm("确定要导出表格数据么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form.unitTown;e.getPostNameByPostCode(t),e.exportTableDataFun(),e.tableDataExportModel=!0,console.log(e.isExportDataComplete)}).catch(function(){})},exportDataTrue:function(){var e=this;a.e(0).then(function(){var t=a("zWO4").exportJsonToExcel,o=e.exportTableData;t(["哨兵编号","姓名","性别","身份证号","职位","哨所级别","哨所名称","哨所编号","哨所职务","手机号","是否拥有计分权限","是否驻村民警"],e.formatJson(["index","sentryName","sentrySex","sentryNumberID","position","postLevel","postName","postNumber","postOffice","sentryTel","isScoring","isSerious"],o),e.tableDataExportPostName+"哨兵列表")}.bind(null,a)).catch(a.oe)},getPostNameByPostCode:function(e){if(""==e)this.tableDataExportPostName="全部";else for(var t in console.log(this.selectTown),this.selectTown)this.selectTown[t].value==e&&(this.tableDataExportPostName=this.selectTown[t].label)},exportTableDataFun:function(){var e=this,t="";t=""==this.form.unitTown?"":this.form.unitTown+"-",console.log(t),console.log("导出表格数据");var a=[];f("/sentry/page?page=0&size=10000&idNumber=&name=&postCode="+t).then(function(t){if(console.log(t),"1"==t.data.code){var o=t.data.data.content;console.log(t.data.data);for(var s=0;s<o.length;s++)console.log(parseInt(s/o.length*100)),e.tableDataExportNum=parseInt(s/o.length*100),a.push({index:(Array(5).join(0)+o[s].allSerial).slice(-5),sentryName:o[s].name,sentrySex:o[s].sex||"未知",sentryNumberID:o[s].idNumber||"未知",position:o[s].position||"未知",postLevel:o[s].postGrade||"未知",postName:o[s].post.name||"未知",postNumber:o[s].post.number||"未知",postOffice:o[s].postOffice||"未知",sentryTel:o[s].phone||"未知",isScoring:o[s].canScoring||"未知",isSerious:o[s].isPolice||"未知"});e.tableDataExportNum=100,e.tableDataExportColor="",e.tableDataExportStatus="success",setTimeout(e.tableDataExportModel=!1,1e3),console.log("下载完成"),console.log(a),e.exportTableData=a,e.isExportDataComplete=!0,e.exportDataTrue(),console.log(e.isExportDataComplete)}else"0"==t.data.code?(e.tableDataExportStatus="exception",e.$message({message:t.data.data,type:"warning"})):"-1"==t.data.code&&(e.tableDataExportStatus="exception",e.$message({message:"网络错误!",type:"error"}))}).catch(function(t){console.log(t),e.tableDataExportStatus="exception",e.$message({message:"网络错误",type:"error"})})},addSentryDataModelTrue:function(){this.addSentryDataModel=!0,this.modelName="添加哨兵",this.isShowSentryUpload=!0,this.isAddType=!0,this.addOrEditSentryData=JSON.parse(i()(this.addOrEditSentryDataEmpty))},indexMethod:function(e){return 1*e},getSelectTown:function(){this.form.postLevel="",this.form.postCode="",this.form.sentryNumberID="",this.form.sentryName="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,console.log(this.form.unitTown),this.getSentryData(this.form)},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){for(var o=a.data.data,s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostLevel:function(){this.selectPostName="",this.form.postCode="",this.form.sentryNumberID="",this.form.sentryName="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getAllPostListFun(),this.getSentryData(this.form)},getSentryName:function(){this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getSentryData(this.form)},getAllPostListFun:function(){var e=this,t=[],a=this.addOrEditSentryData,o=this.form.unitTown||a.postTown,s=this.form.postLevel||a.postLevel;console.log("获取哨所列表"),v("/post/all?code="+o+"-&grade="+s).then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});e.selectPostName=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getSentryData:function(e){var t=this;console.log("搜索关键字："+i()(this.form)),console.log(this.form.unitTown),console.log(this.form.postLevel),console.log(this.form.postCode);var a="";""==e.unitTown&&""==e.postLevel&&""==e.postCode?a="":""!=e.unitTown&&""==e.postLevel&&""==e.postCode?a=e.unitTown+"-":""!=e.unitTown&&""!=e.postLevel&&""==e.postCode?a=e.unitTown+"-"+e.postLevel:""!=e.unitTown&&""!=e.postLevel&&""!=e.postCode&&(a=e.postCode),void 0==a&&(a="");var o=this.form.sentryName||"",s=this.form.sentryNumberID||"",n=[];f("/sentry/page?page="+this.pageNum+"&size="+this.pageStripNum+"&idNumber="+s+"&name="+o+"&postCode="+a).then(function(e){if(console.log(e),"1"==e.data.code){var a=e.data.data.content;console.log(e.data.data),t.tablePageNumber=e.data.data.totalElements,t.$root.count.$emit("getTablePageNumber",t.tablePageNumber);for(var o=0;o<a.length;o++)n.push({sentryName:a[o].name,sentrySex:a[o].sex||"未知",sentryNumberID:a[o].idNumber||"未知",sentryPosition:a[o].position||"未知",postLevel:a[o].postGrade||"未知",postName:a[o].post.name||"未知",postNumber:a[o].post.number||"未知",postOffice:a[o].postOffice||"未知",sentryTel:a[o].phone||"未知",isScoring:a[o].canScoring||"未知",isSerious:a[o].isPolice||"未知",id:a[o].id,sentryId:a[o].sentry.id,sentryCode:a[o].sentryCode,postCode:a[o].postCode,index:(Array(5).join(0)+a[o].allSerial).slice(-5)});console.log(n),t.sentryTableData=n}else"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),t.$message({message:"网络错误",type:"error"})})},editSentryInfo:function(e,t){console.log(e,t),this.modelName="编辑哨兵",this.isShowSentryUpload=!1,this.addSentryDataModel=!0,this.isAddType=!1,this.editSentryId=t.id,this.editSentrysentryId=t.sentryId,this.sentryCode=t.sentryCode,this.postCode=t.postCode,this.addOrEditSentryData.sentryNumber=t.index,this.addOrEditSentryData.sentryName=t.sentryName,this.addOrEditSentryData.sentrySex=t.sentrySex,this.addOrEditSentryData.sentryNumberID=t.sentryNumberID,this.addOrEditSentryData.sentryPosition=t.sentryPosition,this.addOrEditSentryData.postLevel=t.postLevel,this.addOrEditSentryData.postName=t.postName,this.addOrEditSentryData.postNumber=t.postNumber,this.addOrEditSentryData.postOffice=t.postOffice,this.addOrEditSentryData.sentryTel=t.sentryTel,this.addOrEditSentryData.isScoring=t.isScoring,this.addOrEditSentryData.isSerious=t.isSerious},SubmitSentryData:function(){var e,t,a=this;if(this.isAddType){var o={idNumber:this.addOrEditSentryData.sentryNumberID,postCode:this.addOrEditSentryData.postName,postOffice:this.addOrEditSentryData.postOffice,canScoring:this.addOrEditSentryData.isScoring,isPolice:this.addOrEditSentryData.isSerious,phone:this.addOrEditSentryData.sentryTel,position:this.addOrEditSentryData.sentryPosition,postGrade:this.addOrEditSentryData.postLevel,name:this.addOrEditSentryData.sentryName,sex:this.addOrEditSentryData.sentrySex};console.log(o),console.log("add"),y("/sentry/add",o).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"添加哨兵信息成功!"}),a.addOrEditSentryData=JSON.parse(i()(a.addOrEditSentryDataEmpty)),a.addSentryDataModel=!1,a.isShowSentryUpload=!0,a.getSentryData(a.form)):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}else{var s={id:this.editSentryId,allSerial:(Array(5).join(0)+this.addOrEditSentryData.sentryNumber).slice(-5),idNumber:this.addOrEditSentryData.sentryNumberID,postOffice:this.addOrEditSentryData.postOffice,canScoring:this.addOrEditSentryData.isScoring,isPolice:this.addOrEditSentryData.isSerious,phone:this.addOrEditSentryData.sentryTel,position:this.addOrEditSentryData.sentryPosition,name:this.addOrEditSentryData.sentryName,sex:this.addOrEditSentryData.sentrySex,sentryCode:this.sentryCode,postCode:this.postCode,sentry:{id:this.editSentrysentryId,idNumber:this.addOrEditSentryData.sentryNumberID,name:this.addOrEditSentryData.sentryName,sex:this.addOrEditSentryData.sentrySex}};console.log(s),console.log("upload"),(e="/sentry/update",t=s,u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"修改哨兵信息成功!"}),a.addOrEditSentryData=JSON.parse(i()(a.addOrEditSentryDataEmpty)),a.addSentryDataModel=!1,a.isShowSentryUpload=!0,a.getSentryData(a.form)):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}},deleteSentryInfo:function(e,t){var a=this;console.log(e,t);var o=t.id;console.log("delectId:"+o),this.$confirm("此操作将永久删除该哨兵, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteSentryInfoSure(o)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteSentryInfoSure:function(e){var t,a=this;console.log("delete"),console.log(e),(t="/sentry/del?id="+e,u({async:!0,url:g+t,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"删除成功!"}),a.getSentryData(a.form)):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}}},Z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sentryList outerDiv",attrs:{id:"sentryList"}},[a("div",{staticClass:"sentryListBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"数据导出进度",visible:e.tableDataExportModel,width:"30%",center:""},on:{"update:visible":function(t){e.tableDataExportModel=t}}},[a("el-progress",{attrs:{percentage:e.tableDataExportNum,status:e.tableDataExportStatus,color:e.tableDataExportColor}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.modelName,"custom-class":"addOrEditSentry addOrEdit",visible:e.addSentryDataModel,width:"70%"},on:{"update:visible":function(t){e.addSentryDataModel=t}}},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{width:"100%"},attrs:{model:e.addOrEditSentryData,inline:!0,"label-position":"right"}},[a("el-form-item",{attrs:{label:"哨兵编号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入哨兵编号(选填)"},model:{value:e.addOrEditSentryData.sentryNumber,callback:function(t){e.$set(e.addOrEditSentryData,"sentryNumber",t)},expression:"addOrEditSentryData.sentryNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"哨兵姓名","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入姓名"},model:{value:e.addOrEditSentryData.sentryName,callback:function(t){e.$set(e.addOrEditSentryData,"sentryName",t)},expression:"addOrEditSentryData.sentryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择性别"},model:{value:e.addOrEditSentryData.sentrySex,callback:function(t){e.$set(e.addOrEditSentryData,"sentrySex",t)},expression:"addOrEditSentryData.sentrySex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),e._v(" "),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入身份证号"},model:{value:e.addOrEditSentryData.sentryNumberID,callback:function(t){e.$set(e.addOrEditSentryData,"sentryNumberID",t)},expression:"addOrEditSentryData.sentryNumberID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"职位","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入职位"},model:{value:e.addOrEditSentryData.sentryPosition,callback:function(t){e.$set(e.addOrEditSentryData,"sentryPosition",t)},expression:"addOrEditSentryData.sentryPosition"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"单位\\乡镇场","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},model:{value:e.addOrEditSentryData.postTown,callback:function(t){e.$set(e.addOrEditSentryData,"postTown",t)},expression:"addOrEditSentryData.postTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"哨所级别","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择哨所级别"},on:{change:e.getPostLevel},model:{value:e.addOrEditSentryData.postLevel,callback:function(t){e.$set(e.addOrEditSentryData,"postLevel",t)},expression:"addOrEditSentryData.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"哨所名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择哨所名称"},model:{value:e.addOrEditSentryData.postName,callback:function(t){e.$set(e.addOrEditSentryData,"postName",t)},expression:"addOrEditSentryData.postName"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"哨所职务","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择哨所职务"},model:{value:e.addOrEditSentryData.postOffice,callback:function(t){e.$set(e.addOrEditSentryData,"postOffice",t)},expression:"addOrEditSentryData.postOffice"}},[a("el-option",{attrs:{label:"总哨长",value:"总哨长"}}),e._v(" "),a("el-option",{attrs:{label:"副总哨长",value:"副总哨长"}}),e._v(" "),a("el-option",{attrs:{label:"哨长",value:"哨长"}}),e._v(" "),a("el-option",{attrs:{label:"副哨长",value:"副哨长"}}),e._v(" "),a("el-option",{attrs:{label:"哨兵",value:"哨兵"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入手机号"},model:{value:e.addOrEditSentryData.sentryTel,callback:function(t){e.$set(e.addOrEditSentryData,"sentryTel",t)},expression:"addOrEditSentryData.sentryTel"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"计分权限","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择是否有计分权限"},model:{value:e.addOrEditSentryData.isScoring,callback:function(t){e.$set(e.addOrEditSentryData,"isScoring",t)},expression:"addOrEditSentryData.isScoring"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowSentryUpload,expression:"isShowSentryUpload"}],attrs:{label:"处理严重事件","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择是否可处理严重事件"},model:{value:e.addOrEditSentryData.isSerious,callback:function(t){e.$set(e.addOrEditSentryData,"isSerious",t)},expression:"addOrEditSentryData.isSerious"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"batchAddSentry",staticStyle:{display:"none"}},[a("el-button",{attrs:{size:"mini",round:""}},[e._v("导入表格")]),e._v(" "),a("input",{attrs:{id:"upload",type:"file",value:"导入表格",accept:".xls,.xlsx,.csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:function(t){e.importfxx(this)}}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addSentryDataModel=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.SubmitSentryData}},[e._v("提交")])],1)],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},on:{change:e.getSelectTown},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",clearable:"",placeholder:"哨所等级"},on:{change:e.getPostLevel},model:{value:e.form.postLevel,callback:function(t){e.$set(e.form,"postLevel",t)},expression:"form.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所名称"},on:{change:e.getSentryName},model:{value:e.form.postCode,callback:function(t){e.$set(e.form,"postCode",t)},expression:"form.postCode"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请输入身份证",clearable:""},on:{change:e.getSentryData},model:{value:e.form.sentryNumberID,callback:function(t){e.$set(e.form,"sentryNumberID",t)},expression:"form.sentryNumberID"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"请输入姓名",clearable:""},on:{change:e.getSentryData},model:{value:e.form.sentryName,callback:function(t){e.$set(e.form,"sentryName",t)},expression:"form.sentryName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",loading:e.loading},on:{click:e.getSentryData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-download",loading:e.loading},on:{click:e.export_Excel}},[e._v("导出数据")]),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"0",top:"4px"},attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addSentryDataModelTrue}},[e._v("添加哨兵")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{key:"id",staticStyle:{width:"100%"},attrs:{data:e.sentryTableData,sentryId:"sentryId"}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"姓名"}},[a("span",[e._v(e._s(t.row.sentryName))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("span",[e._v(e._s(t.row.sentrySex))])]),e._v(" "),a("el-form-item",{attrs:{label:"身份证号"}},[a("span",[e._v(e._s(t.row.sentryNumberID))])]),e._v(" "),a("el-form-item",{attrs:{label:"职位"}},[a("span",[e._v(e._s(t.row.postOffice))])]),e._v(" "),a("el-form-item",{attrs:{label:"哨所级别"}},[a("span",[e._v(e._s(t.row.postLevel))])]),e._v(" "),a("el-form-item",{attrs:{label:"哨所名称"}},[a("span",[e._v(e._s(t.row.postName))])]),e._v(" "),a("el-form-item",{attrs:{label:"哨所编号"}},[a("span",[e._v(e._s(t.row.postNumber))])]),e._v(" "),a("el-form-item",{attrs:{label:"哨所职务"}},[a("span",[e._v(e._s(t.row.sentryPosition))])]),e._v(" "),a("el-form-item",{attrs:{label:"手机号"}},[a("span",[e._v(e._s(t.row.sentryTel))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"哨兵编号",prop:"index",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"sentryName",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"身份证号",prop:"sentryNumberID",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{label:"职位",prop:"sentryPosition",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所名称",prop:"postName"}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所职务",prop:"postOffice",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit",on:{click:function(a){a.stopPropagation(),e.editSentryInfo(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deleteSentryInfo(t.$index,t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("my-paging")],1)],1)],1)],1)])},staticRenderFns:[]};var Y=a("C7Lr")(W,Z,!1,function(e){a("HQ9v")},null,null).exports,Q={data:function(){return{tableDataExportModel:!1,tableDataExportNum:0,tableDataExportColor:"#8e71c7",tableDataExportStatus:"",formLabelWidth:"120",tableDataExportPostName:"",exportTableData:[],isExportDataComplete:!1,YearMonthDay:"",isShowEditUser:!0,loading:!1,form:{unitTown:"",postLevel:"",postCode:"",sentryName:"",startTime:"",endTime:"",eventState:"1",reportTime:"",passSentryName:"",way:"",reportStartTime:"",reportEndTime:""},pageNum:0,pageStripNum:10,selectTown:[],selectPostName:[],exchangeTableData:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},isReportStartTime:!0}},components:{myAside:k,myPaging:I,myHeader:z},computed:{},created:function(){var e=this;"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0),this.getTownList(),this.getTableData(),this.$root.page.$on("getIntegralListTable",function(t){e.pageNum=t-1,console.log(e.pageNum),e.getTableData()})},destroyed:function(){for(var e in console.log("离开当前页面后执行"),this.form)this.form[e]=""},methods:{unlockReportEndTime:function(){null!=this.form.reportStartTime&&(this.isReportStartTime=!1)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},export_Excel:function(){var e=this;this.$confirm("确定要导出表格数据么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form.unitTown;console.log(t),e.getPostNameByPostCode(t),e.exportTableDataFun(),e.tableDataExportModel=!0,console.log(e.isExportDataComplete)}).catch(function(e){console.log(e)})},exportDataTrue:function(){var e=this;a.e(0).then(function(){var t=a("zWO4").exportJsonToExcel,o=e.exportTableData;t(["积分类型","申请人","申请时间","积分数","处理人"],e.formatJson(["way","applyName","applyTime","exchangeNum","passSentryName"],o),e.tableDataExportPostName+"积分列表")}.bind(null,a)).catch(a.oe)},getYearMonthDay:function(){},getPostNameByPostCode:function(e){if(""==e)this.tableDataExportPostName="全部";else for(var t in console.log(this.selectTown),this.selectTown)this.selectTown[t].value==parseInt(e)&&(this.tableDataExportPostName=this.selectTown[t].label)},exportTableDataFun:function(){var e=this,t="";t=""==this.form.unitTown?"":this.form.unitTown+"-",console.log("导出表格数据");var a=[];w("/integral/detailPage?page=0&size=10000&postCode="+t+"&sentryName=&isPass=&time=").then(function(t){if(console.log(t),"1"==t.data.code){var o=t.data.data.content;console.log(t.data.data);for(var s=0;s<o.length;s++)console.log(parseInt(s/o.length*100)),e.tableDataExportNum=parseInt(s/o.length*100),a.push({exchangeResult:0==o[s].isPass?"待审批":(1==o[s].isPass?"已完成":"已拒绝")||"未知",applyName:o[s].sentryName||"未知",applyTime:o[s].time||"未知",exchangeNum:Math.abs(o[s].number)||"未知",handleName:o[s].passSentryName||"未知",shopName:o[s].shopName||"未知",goodsName:o[s].goodsName||"未知",shopAddress:o[s].address||"未知",shopBossName:o[s].bossName||"未知",shopBossPhone:o[s].bossPhone||"未知",passSentryName:o[s].passSentryName,way:0==o[s].way?"上报事件":1==o[s].way?"积分兑换":"哨长扣分"});e.tableDataExportNum=100,e.tableDataExportColor="",e.tableDataExportStatus="success",setTimeout(e.tableDataExportModel=!1,1e3),console.log("下载完成"),console.log(a),e.exportTableData=a,e.isExportDataComplete=!0,e.exportDataTrue()}else"0"==t.data.code?(e.tableDataExportStatus="exception",e.$message({message:t.data.data,type:"warning"})):"-1"==t.data.code&&(e.tableDataExportStatus="exception",e.$message({message:"网络错误!",type:"error"}))}).catch(function(t){console.log(t),e.tableDataExportStatus="exception",e.$message({message:"网络错误",type:"error"})})},indexMethod:function(e){return 1*e},getSelectTown:function(){this.form.postLevel="",this.form.postCode="",this.form.eventState="",this.form.sentryName="",this.form.reportTime="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,console.log(this.form.unitTown),this.getTableData()},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)console.log("***"),t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostLevel:function(){this.selectPostName="",this.form.postCode="",this.form.eventState="",this.form.sentryName="",this.form.reportTime="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getAllPostListFun(),this.getTableData()},getPostName:function(){this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getTableData()},getIntegralState:function(){},getIntegralTime:function(){},getAllPostListFun:function(){var e=this,t=[],a=this.form.unitTown,o=this.form.postLevel;console.log(a),console.log(o),console.log("获取哨所列表"),v("/post/all?code="+a+"-&grade="+o).then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectPostName=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getTableData:function(){var e=this;console.log("搜索关键字："+i()(this.form));var t=this.form,a="";""==t.unitTown&&""==t.postLevel&&""==t.postCode?a="":""!=t.unitTown&&""==t.postLevel&&""==t.postCode?a=t.unitTown+"-":""!=t.unitTown&&""!=t.postLevel&&""==t.postCode?a=t.unitTown+"-"+t.postLevel:""!=t.unitTown&&""!=t.postLevel&&""!=t.postCode&&(a=t.postCode);var o=t.sentryName,s=t.eventState,n=t.reportTime,l=t.reportStartTime;console.log(parseInt(t.reportEndTime.split("-")[2])+1);var r=new Array;r[0]=t.reportEndTime.split("-")[0],r[1]=t.reportEndTime.split("-")[1],r[2]=parseInt(t.reportEndTime.split("-")[2])+1<10?"0"+(parseInt(t.reportEndTime.split("-")[2])+1):parseInt(t.reportEndTime.split("-")[2])+1;var c=r.join("-");null==n&&(n=""),null==l&&(n=""),null==c&&(n="");var d=this.pageNum,p=this.pageStripNum,m=t.way,u=t.passSentryName;console.log(n);var g=[];w("/integral/integralDetailPage?page="+d+"&size="+p+"&postCode="+a+"&sentryName="+o+"&isPass="+s+"&startTime="+l+"&endTime="+c+"&way="+m+"&passSentryCode=&passSentryName="+u).then(function(t){if(console.log(t),"1"==t.data.code){var a=t.data.data.content;console.log(t.data.data),e.tablePageNumber=t.data.data.totalElements,e.$root.count.$emit("getTablePageNumber",e.tablePageNumber);for(var o=0;o<a.length;o++)g.push({exchangeResult:0==a[o].isPass?"待审批":(1==a[o].isPass?"已完成":"已拒绝")||"未知",applyName:a[o].sentryName||"未知",applyTime:a[o].time||"未知",exchangeNum:a[o].number||0,handleName:a[o].passSentryName||"未知",shopName:a[o].shopName||"未知",goodsName:a[o].goodsName||"未知",shopAddress:a[o].address||"未知",shopBossName:a[o].bossName||"未知",shopBossPhone:a[o].bossPhone||"未知",id:a[o].id,passSentryName:a[o].passSentryName,way:0==a[o].way?"上报事件":1==a[o].way?"积分兑换":"哨长扣分"});console.log(g),e.exchangeTableData=g}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){e.$message({message:"网络错误",type:"error"})})},deleteIntegralApply:function(e,t){var a=this;console.log(e,t);var o=t.id;console.log("delectId:"+o),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteIntegralApplySure(o)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteIntegralApplySure:function(e){var t,a=this;console.log("delete"),console.log(e),(t="/integral/delDetail?id="+e,u({async:!0,url:g+t,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"删除成功!"}),a.getTableData()):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"IntegralList outerDiv",attrs:{id:"IntegralList"}},[a("div",{staticClass:"IntegralListBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"数据导出进度",visible:e.tableDataExportModel,width:"30%",center:""},on:{"update:visible":function(t){e.tableDataExportModel=t}}},[a("el-progress",{attrs:{percentage:e.tableDataExportNum,status:e.tableDataExportStatus,color:e.tableDataExportColor}})],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},on:{change:e.getSelectTown},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所等级"},on:{change:e.getPostLevel},model:{value:e.form.postLevel,callback:function(t){e.$set(e.form,"postLevel",t)},expression:"form.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所名称"},on:{change:e.getPostName},model:{value:e.form.postCode,callback:function(t){e.$set(e.form,"postCode",t)},expression:"form.postCode"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"上报哨兵姓名",clearable:""},on:{change:e.getTableData},model:{value:e.form.sentryName,callback:function(t){e.$set(e.form,"sentryName",t)},expression:"form.sentryName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"审批人姓名",clearable:""},on:{change:e.getTableData},model:{value:e.form.passSentryName,callback:function(t){e.$set(e.form,"passSentryName",t)},expression:"form.passSentryName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"积分类型"},on:{change:e.getPostLevel},model:{value:e.form.way,callback:function(t){e.$set(e.form,"way",t)},expression:"form.way"}},[a("el-option",{attrs:{label:"上报事件",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"积分兑换",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"哨长扣分",value:"2"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"100px",display:"none"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"审批状态"},on:{change:e.getIntegralState},model:{value:e.form.eventState,callback:function(t){e.$set(e.form,"eventState",t)},expression:"form.eventState"}},[a("el-option",{attrs:{label:"审批中",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"已完成",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"被拒绝",value:"2"}})],1),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small","value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"开始时间","picker-options":e.pickerOptions},on:{change:e.unlockReportEndTime},model:{value:e.form.reportStartTime,callback:function(t){e.$set(e.form,"reportStartTime",t)},expression:"form.reportStartTime"}}),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small",disabled:e.isReportStartTime,"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"结束时间","picker-options":e.pickerOptions},model:{value:e.form.reportEndTime,callback:function(t){e.$set(e.form,"reportEndTime",t)},expression:"form.reportEndTime"}}),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",loading:e.loading},on:{click:e.getTableData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-download",loading:e.loading},on:{click:e.export_Excel}},[e._v("导出数据")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.exchangeTableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"积分类型",prop:"way"}}),e._v(" "),a("el-table-column",{attrs:{label:"申请人",prop:"applyName"}}),e._v(" "),a("el-table-column",{attrs:{label:"申请时间",prop:"applyTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"积分数",prop:"exchangeNum"}}),e._v(" "),a("el-table-column",{attrs:{label:"处理人",prop:"passSentryName"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deleteIntegralApply(t.$index,t.row)}}})]}}])})],1)],1)],1),e._v(" "),a("my-paging")],1)],1)],1)],1)])},staticRenderFns:[]};var q={data:function(){return{tableDataExportModel:!1,tableDataExportNum:0,tableDataExportColor:"#8e71c7",tableDataExportStatus:"",formLabelWidth:"120",tableDataExportPostName:"",exportTableData:[],isExportDataComplete:!1,YearMonthDay:"",isShowEditUser:!0,loading:!1,isShowPie:!1,form:{unitTown:"",postLevel:"",postCode:"",sentryName:""},pageNum:0,pageStripNum:10,selectTown:[],selectPostName:[],exchangeTableData:[]}},components:{myAside:k,myPaging:I,myHeader:z},computed:{},created:function(){var e=this;"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0),this.getTownList(),this.getTableData(),this.$root.page.$on("getIntegralrankTable",function(t){e.pageNum=t-1,console.log(e.pageNum),e.getTableData()})},destroyed:function(){for(var e in console.log("离开当前页面后执行"),this.form)this.form[e]=""},methods:{formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},export_Excel:function(){var e=this;this.$confirm("确定要导出表格数据么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form.unitTown;console.log(t),e.getPostNameByPostCode(t),e.exportTableDataFun(),e.tableDataExportModel=!0,console.log(e.isExportDataComplete)}).catch(function(e){console.log(e)})},exportDataTrue:function(){var e=this;a.e(0).then(function(){var t=a("zWO4").exportJsonToExcel,o=e.exportTableData;t(["姓名","总积分","可用积分"],e.formatJson(["sentryName","allAmount","amount"],o),e.tableDataExportPostName+"个人积分列表")}.bind(null,a)).catch(a.oe)},getYearMonthDay:function(){},getPostNameByPostCode:function(e){if(""==e)this.tableDataExportPostName="全部";else for(var t in console.log(this.selectTown),this.selectTown)this.selectTown[t].value==parseInt(e)&&(this.tableDataExportPostName=this.selectTown[t].label)},exportTableDataFun:function(){var e=this,t="";t=""==this.form.unitTown?"":this.form.unitTown+"-",console.log("导出表格数据");var a=[];x("/integral/page?page=0&size=10000&postCode="+t+"&sentryName=").then(function(t){if(console.log(t),"1"==t.data.code){var o=t.data.data.content;console.log(t.data.data);for(var s=0;s<o.length;s++)console.log(parseInt(s/o.length*100)),e.tableDataExportNum=parseInt(s/o.length*100),a.push({sentryName:o[s].sentryName,allAmount:o[s].allAmount,amount:o[s].amount,sentryCode:o[s].sentryCode});e.tableDataExportNum=100,e.tableDataExportColor="",e.tableDataExportStatus="success",setTimeout(e.tableDataExportModel=!1,1e3),console.log("下载完成"),console.log(a),e.exportTableData=a,e.isExportDataComplete=!0,e.exportDataTrue()}else"0"==t.data.code?(e.tableDataExportStatus="exception",e.$message({message:t.data.data,type:"warning"})):"-1"==t.data.code&&(e.tableDataExportStatus="exception",e.$message({message:"网络错误!",type:"error"}))}).catch(function(t){console.log(t),e.tableDataExportStatus="exception",e.$message({message:"网络错误",type:"error"})})},indexMethod:function(e){return 1*e},getSelectTown:function(){this.form.postLevel="",this.form.postCode="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,console.log(this.form.unitTown),this.getTableData()},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)console.log("***"),t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getPostLevel:function(){this.selectPostName="",this.form.postCode="",this.form.sentryName="",this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getAllPostListFun(),this.getTableData()},getPostName:function(){this.currentPage=1,this.$root.count.$emit("pageReturnZero",this.currentPage),this.pageNum=0,this.getTableData()},getAllPostListFun:function(){var e=this,t=[],a=this.form.unitTown,o=this.form.postLevel;console.log(a),console.log(o),console.log("获取哨所列表"),v("/post/all?code="+a+"-&grade="+o).then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectPostName=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},getTableData:function(){var e=this;console.log("搜索关键字："+i()(this.form));var t=this.form,a="";""==t.unitTown&&""==t.postLevel&&""==t.postCode?a="":""!=t.unitTown&&""==t.postLevel&&""==t.postCode?a=t.unitTown+"-":""!=t.unitTown&&""!=t.postLevel&&""==t.postCode?a=t.unitTown+"-"+t.postLevel:""!=t.unitTown&&""!=t.postLevel&&""!=t.postCode&&(a=t.postCode);var o=t.sentryName,s=[];x("/integral/page?page="+this.pageNum+"&size="+this.pageStripNum+"&postCode="+a+"&sentryName="+o).then(function(t){if(console.log(t),"1"==t.data.code){var a=t.data.data.content;console.log(t.data.data),e.tablePageNumber=t.data.data.totalElements,e.$root.count.$emit("getTablePageNumber",e.tablePageNumber);for(var o=0;o<a.length;o++)s.push({sentryName:a[o].sentryName,allAmount:a[o].allAmount,amount:a[o].amount,sentryCode:a[o].sentryCode,id:a[o].id});console.log(s),e.exchangeTableData=s}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},drewFun:function(){this.$echarts.init(document.getElementById("myChart")).setOption({title:{text:"在Vue中使用echarts"},tooltip:{},xAxis:{data:["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]},yAxis:{},series:[{name:"销量",type:"bar",data:[5,20,36,10,10,20]}]})}}},G={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"IntegralRank outerDiv",attrs:{id:"IntegralRank"}},[a("div",{staticClass:"IntegralRankBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"数据导出进度",visible:e.tableDataExportModel,width:"30%",center:""},on:{"update:visible":function(t){e.tableDataExportModel=t}}},[a("el-progress",{attrs:{percentage:e.tableDataExportNum,status:e.tableDataExportStatus,color:e.tableDataExportColor}})],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},on:{change:e.getSelectTown},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所等级"},on:{change:e.getPostLevel},model:{value:e.form.postLevel,callback:function(t){e.$set(e.form,"postLevel",t)},expression:"form.postLevel"}},[a("el-option",{attrs:{label:"一级哨所",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级哨所",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级哨所",value:"3"}})],1),e._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"哨所名称"},on:{change:e.getPostName},model:{value:e.form.postCode,callback:function(t){e.$set(e.form,"postCode",t)},expression:"form.postCode"}},e._l(e.selectPostName,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"上报哨兵姓名",clearable:""},on:{change:e.getTableData},model:{value:e.form.sentryName,callback:function(t){e.$set(e.form,"sentryName",t)},expression:"form.sentryName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",loading:e.loading},on:{click:e.getTableData}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-download",loading:e.loading},on:{click:e.export_Excel}},[e._v("导出数据")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.exchangeTableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"sentryName"}}),e._v(" "),a("el-table-column",{attrs:{label:"总积分",prop:"allAmount"}}),e._v(" "),a("el-table-column",{attrs:{label:"可用积分",prop:"amount"}}),e._v(" "),a("el-table-column",{attrs:{label:"哨所编号",prop:"sentryCode"}})],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isShowPie,expression:"isShowPie"}]},[a("div",{style:{width:"300px",height:"300px"},attrs:{id:"myChart"}})])],1),e._v(" "),a("my-paging")],1)],1)],1)],1)])},staticRenderFns:[]};var H={data:function(){return{displayReportEvent:!1,isShowEditUser:!0,loading:!1,addUserDataModel:!1,formLabelWidth:"120",addOrEditUserData:{userName:"",password:"",grade:"",nickName:"",headImage:""},modelName:"添加用户",isShowUserUpload:!0,isAddType:!0,editUserId:"",exchangeTableData:[],VacancySentryIdList:{},displayVacancySentryId:!1,form:{unitTown:"",reportStartTime:"",reportEndTime:""},selectTown:[],YearMonthDay:"",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},isReportStartTime:!0}},components:{myHeader:z},computed:{},created:function(){"1"==JSON.parse(sessionStorage.getItem("user")).grade&&(this.isShowEditUser=!0),this.getTableData(),this.addOrEditUserDataEmpty=JSON.parse(i()(this.addOrEditUserData)),this.getTownList(),this.getVacancySentryIdData(),this.getReportEventTypeData()},methods:{unlockReportEndTime:function(){null!=this.form.reportStartTime&&(this.isReportStartTime=!1)},getTownList:function(){var e=this,t=[];console.log("获取乡镇县直单位"),h("/unit/all").then(function(a){if("1"==a.data.code){var o=a.data.data;console.log(o);for(var s=0;s<o.length;s++)console.log("***"),t.push({value:o[s].code,label:o[s].name});console.log(t),e.selectTown=t}else"0"==a.data.code?e.$message({message:a.data.data,type:"warning"}):"-1"==a.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},addUserDataModelTrue:function(){this.addUserDataModel=!0,this.modelName="添加用户",this.isShowUserUpload=!0,this.isAddType=!0,this.addOrEditUserData=JSON.parse(i()(this.addOrEditUserDataEmpty))},indexMethod:function(e){return 1*e},getTableData:function(){var e,t=this,a=[];(e="/admin/all",u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){if(console.log(e),"1"==e.data.code){var o=e.data.data;console.log(e.data.data);for(var s=0;s<o.length;s++)a.push({nickName:o[s].nickName,grade:o[s].grade,headImage:o[s].headImage,userName:o[s].userName,password:o[s].password,id:o[s].id});console.log(a),t.exchangeTableData=a}else"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),t.$message({message:"网络错误",type:"error"})})},getVacancySentryIdData:function(){var e,t=this,a=[];(e="/data/unlessSerial",u({async:!0,url:g+e,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){if(console.log(e),"1"==e.data.code){var o=e.data.data;console.log(e.data.data);for(var s=0;s<o.length;s++)a.push[(Array(5).join(0)+o[s]).slice(-5)];console.log(a),t.VacancySentryIdList=o}else"0"==e.data.code?t.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&t.$message({message:"网络错误!",type:"error"})}).catch(function(e){console.log(e),t.$message({message:"网络错误",type:"error"})})},getReportEventTypeData:function(){var e=this;console.log("搜索关键字："+i()(this.form));var t=this.form,a="";""==t.unitTown&&""==t.postLevel&&""==t.postCode?a="":""!=t.unitTown&&""==t.postLevel&&""==t.postCode?a=t.unitTown+"-":""!=t.unitTown&&""!=t.postLevel&&""==t.postCode?a=t.unitTown+"-"+t.postLevel:""!=t.unitTown&&""!=t.postLevel&&""!=t.postCode&&(a=t.postCode);var o=t.reportTime,s=t.reportStartTime;console.log(parseInt(t.reportEndTime.split("-")[2])+1);var n=new Array;n[0]=t.reportEndTime.split("-")[0],n[1]=t.reportEndTime.split("-")[1],n[2]=parseInt(t.reportEndTime.split("-")[2])+1<10?"0"+(parseInt(t.reportEndTime.split("-")[2])+1):parseInt(t.reportEndTime.split("-")[2])+1;var l=n.join("-");null==o&&(o=""),null==s&&(o=""),null==l&&(o="");D("/report/eventCount?postCode="+a+"&person=&eventName=&startTime="+s+"&endTime="+l).then(function(t){if("1"==t.data.code){t.data.data;console.log(t.data.data)}else"0"==t.data.code?e.$message({message:t.data.data,type:"warning"}):"-1"==t.data.code&&e.$message({message:"网络错误!",type:"error"})}).catch(function(t){console.log(t),e.$message({message:"网络错误",type:"error"})})},editSentryInfo:function(e,t){console.log(e,t),this.modelName="编辑哨兵",this.isShowUserUpload=!1,this.addUserDataModel=!0,this.isAddType=!1,this.editUserId=t.id,this.addOrEditUserData.userName=t.userName,this.addOrEditUserData.password=t.password,this.addOrEditUserData.grade=t.grade,this.addOrEditUserData.nickName=t.nickName,this.addOrEditUserData.headImage=t.headImage},SubmitUserData:function(){var e,t,a=this;if(this.isAddType){var o={userName:this.addOrEditUserData.userName,password:this.addOrEditUserData.password,grade:this.addOrEditUserData.grade,nickName:this.addOrEditUserData.nickName,headImage:this.addOrEditUserData.headImage};console.log(o),console.log("add"),(e="/admin/add",t=o,u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"添加用户信息成功!"}),a.addOrEditUserData=JSON.parse(i()(a.addOrEditUserDataEmpty)),a.addUserDataModel=!1,a.isShowUserUpload=!0,a.getTableData()):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}else{var s={id:this.editUserId,password:this.addOrEditUserData.password,grade:this.addOrEditUserData.grade,nickName:this.addOrEditUserData.nickName};console.log(s),console.log("upload"),function(e,t){return u({async:!0,url:g+e,method:"post",headers:{"content-type":"application/json","cache-control":"no-cache"},data:t})}("/admin/update",s).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"修改哨兵信息成功!"}),a.addOrEditUserData=JSON.parse(i()(a.addOrEditUserDataEmpty)),a.addUserDataModel=!1,a.isShowUserUpload=!0,a.getTableData()):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}},deleteUserInfo:function(e,t){var a=this;console.log(e,t);var o=t.id;console.log("delectId:"+o),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteUserInfoSure(o)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteUserInfoSure:function(e){var t,a=this;console.log("delete"),console.log(e),(t="/admin/delete?id="+e,u({async:!0,url:g+t,method:"get",headers:{"content-type":"application/json","cache-control":"no-cache"}})).then(function(e){console.log(e),"1"==e.data.code?(a.$message({type:"success",message:"删除成功!"}),a.getTableData()):"0"==e.data.code?a.$message({message:e.data.data,type:"warning"}):"-1"==e.data.code&&a.$message({message:"网络错误!",type:"error"})}).catch(function(e){a.$message({message:"网络错误!",type:"error"})})}}},K={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userManage outerDiv",attrs:{id:"userManage"}},[a("div",{staticClass:"userManageBox withinDiv"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-row",{staticClass:"asideDiv"},[a("el-col",{staticClass:"aside",attrs:{span:24}},[a("span",{staticClass:"logoSpan"},[a("i",[e._v("综治哨所")]),e._v(" "),a("i",[e._v("后台管理系统")])]),e._v(" "),a("div",{staticClass:"parentNav"},[a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-fl-renshi"}),e._v(" "),a("router-link",{attrs:{to:"/sentrylist"}},[e._v("哨兵管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-suozaidi"}),e._v(" "),a("router-link",{attrs:{to:"/postlist"}},[e._v("哨所管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-paihang"}),e._v(" "),a("router-link",{attrs:{to:"/Integralrank"}},[e._v("积分排行")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-jifen3"}),e._v(" "),a("router-link",{attrs:{to:"/Integrallist"}},[e._v("积分管理")])],1),e._v(" "),a("div",{staticClass:"nav"},[a("i",{staticClass:"icon iconfont icon-shijianchaxun-"}),e._v(" "),a("router-link",{attrs:{to:"/reporteventlist"}},[e._v("事件管理")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowEditUser,expression:"isShowEditUser"}],staticClass:"nav active"},[a("i",{staticClass:"icon iconfont icon-geren9"}),e._v(" "),a("router-link",{attrs:{to:"/userManage"}},[e._v("管理中心")])],1)])])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{height:"40px"}},[a("my-header")],1),e._v(" "),a("el-main",{staticStyle:{"border-top":"1rem solid #eee"}},[a("div",{staticClass:"sentryListMain"},[a("el-dialog",{attrs:{title:"显示上报事件分布详情",visible:e.displayReportEvent,width:"50%",center:""},on:{"update:visible":function(t){e.displayReportEvent=t}}},[a("el-form-item",[a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"请选择单位\\乡镇场"},on:{change:e.getReportEventTypeData},model:{value:e.form.unitTown,callback:function(t){e.$set(e.form,"unitTown",t)},expression:"form.unitTown"}},e._l(e.selectTown,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small","value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"开始时间","picker-options":e.pickerOptions},on:{change:e.unlockReportEndTime},model:{value:e.form.reportStartTime,callback:function(t){e.$set(e.form,"reportStartTime",t)},expression:"form.reportStartTime"}}),e._v(" "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{size:"small",disabled:e.isReportStartTime,"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"结束时间","picker-options":e.pickerOptions},on:{change:e.getReportEventTypeData},model:{value:e.form.reportEndTime,callback:function(t){e.$set(e.form,"reportEndTime",t)},expression:"form.reportEndTime"}})],1),e._v(" "),a("div",{style:{width:"300px",height:"300px"},attrs:{id:"myChart"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.displayReportEvent=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.displayReportEvent=!1}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"空缺的哨兵编号",visible:e.displayVacancySentryId,width:"50%",center:""},on:{"update:visible":function(t){e.displayVacancySentryId=t}}},[e._l(e.VacancySentryIdList,function(t){return a("span",{key:t,staticStyle:{width:"10%",display:"inline-block","margin-bottom":"10px"}},[e._v(e._s((Array(5).join(0)+t).slice(-5)))])}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.displayVacancySentryId=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.displayVacancySentryId=!1}}},[e._v("确 定")])],1)],2),e._v(" "),a("el-dialog",{attrs:{title:e.modelName,"custom-class":"addOrEditSentry addOrEdit",visible:e.addUserDataModel,width:"70%"},on:{"update:visible":function(t){e.addUserDataModel=t}}},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{width:"100%"},attrs:{model:e.addOrEditUserData,inline:!0,"label-position":"right"}},[a("el-form-item",{attrs:{label:"昵称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入昵称"},model:{value:e.addOrEditUserData.nickName,callback:function(t){e.$set(e.addOrEditUserData,"nickName",t)},expression:"addOrEditUserData.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"等级","label-width":e.formLabelWidth}},[a("el-select",{attrs:{size:"small",placeholder:"请选择等级"},model:{value:e.addOrEditUserData.grade,callback:function(t){e.$set(e.addOrEditUserData,"grade",t)},expression:"addOrEditUserData.grade"}},[a("el-option",{attrs:{label:"1",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"2",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"3",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowUserUpload,expression:"isShowUserUpload"}],attrs:{label:"账号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入账号"},model:{value:e.addOrEditUserData.userName,callback:function(t){e.$set(e.addOrEditUserData,"userName",t)},expression:"addOrEditUserData.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入密码"},model:{value:e.addOrEditUserData.password,callback:function(t){e.$set(e.addOrEditUserData,"password",t)},expression:"addOrEditUserData.password"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowUserUpload,expression:"isShowUserUpload"}],attrs:{label:"头像地址","label-width":e.formLabelWidth}},[a("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入在线头像地址"},model:{value:e.addOrEditUserData.headImage,callback:function(t){e.$set(e.addOrEditUserData,"headImage",t)},expression:"addOrEditUserData.headImage"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addUserDataModel=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.SubmitUserData}},[e._v("提交")])],1)],1),e._v(" "),a("el-row",{staticClass:"searchForm"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0}},[a("el-form-item",[a("el-button",{staticStyle:{position:"absolute",right:"350px",top:"4px",display:"none"},attrs:{size:"small"},on:{click:function(t){e.displayReportEvent=!0}}},[e._v("查看上报事件分布")]),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"150px",top:"4px"},attrs:{size:"small"},on:{click:function(t){e.displayVacancySentryId=!0}}},[e._v("查看空缺哨兵编号列表")]),e._v(" "),a("el-button",{staticStyle:{position:"absolute",right:"0",top:"4px"},attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addUserDataModelTrue}},[e._v("添加用户")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.exchangeTableData}},[a("el-table-column",{attrs:{label:"序号",type:"index",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"昵称",prop:"nickName"}}),e._v(" "),a("el-table-column",{attrs:{label:"等级",prop:"grade"}}),e._v(" "),a("el-table-column",{attrs:{label:"头像地址",prop:"headImage"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",prop:"userName"}}),e._v(" "),a("el-table-column",{attrs:{label:"密码",prop:"password"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit",on:{click:function(a){a.stopPropagation(),e.editUserInfo(t.$index,t.row)}}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deleteUserInfo(t.$index,t.row)}}})]}}])})],1)],1)],1)])],1)],1)],1)])},staticRenderFns:[]};var X=[{path:"/",name:"登录",component:E},{path:"/index",name:"登录",component:E},{path:"/Integrallist",name:"积分列表",component:a("C7Lr")(Q,V,!1,function(e){a("cZc5")},null,null).exports},{path:"/postlist",name:"哨所模块",component:B},{path:"/reporteventlist",name:"事件模块",component:J},{path:"/sentrylist",name:"哨兵模块",component:Y},{path:"/Integralrank",name:"积分排行",component:a("C7Lr")(q,G,!1,function(e){a("McPR")},null,null).exports},{path:"/userManage",name:"用户管理",component:a("C7Lr")(H,K,!1,function(e){a("pCrx")},null,null).exports}],ee=a("t+b9"),te=a.n(ee),ae=a("5YEj"),oe=a.n(ae);a("/Hv2"),a("0BjV");o.default.config.productionTip=!1,o.default.use(te.a),o.default.use(l.a);var se=new l.a({mode:"history",routes:X});o.default.prototype.$echarts=oe.a,o.default.prototype.$ajax=m.a,o.default.prototype.hostUrl="http://116.62.138.218:8889",se.beforeEach(function(e,t,a){console.log("页面访问路径："+e.path),"/index"!=e.path&&"/"!=e.path||sessionStorage.removeItem("user"),JSON.parse(sessionStorage.getItem("user"))||"/index"==e.path?a(function(){console.log("刷新页面")}):a({path:"/index"})}),new o.default({el:"#app",router:se,components:{App:n},template:"<App/>",data:{page:new o.default,count:new o.default}})},Rh3i:function(e,t){},cVKh:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAHFJREFUOBFjYBgFoyFA/RBQAhrJRoSxkkA1/MjqmJA5QPY3IDYDYnyGSQPlFYH4KxDjBRJAWRsgxmYYyBArIGYBYqIANsNINgRmE7JhBA1hhunCQn8Biv0CYgcgZgfik0D8B4jJBnJAndjCi2wDh5hGAMmECPD1t1KCAAAAAElFTkSuQmCC"},cZc5:function(e,t){},pCrx:function(e,t){},"w+Yn":function(e,t){},yx2Z:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.5b3be37ae8830319e5cb.js.map